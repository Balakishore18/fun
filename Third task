import paramiko

# Set up the connection parameters based on your server.
sftp_host = "your.sftp.host"
sftp_port = 22  # or your custom port
sftp_username = "your_username"
sftp_password = "your_password"

# Initialize the SSH client
client = paramiko.SSHClient()

# Automatically add the server's SSH key (unsafe for production, see below)
client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

try:
    # Connect to the SFTP server
    client.connect(sftp_host, port=sftp_port, username=sftp_username, password=sftp_password)
    
    # Open an SFTP session on the SSH server
    sftp = client.open_sftp()
    
    # Navigate to the directory and list files
    sftp.chdir('your/directory/path')
    for filename in sftp.listdir():
        print(filename)
    
    # Close the SFTP session
    sftp.close()

except Exception as e:
    print(f"An error occurred: {e}")

finally:
    # Close the client connection
    client.close()
