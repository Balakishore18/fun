from main_cosmos_operations import CosmosOperations

def call_operations(config_file='config.json'):
    client, database_name, container_name = CosmosOperations.client_init(config_file)
    
    # Create a database
    CosmosOperations.create_database(client, database_name)

    # Create a container
    CosmosOperations.create_container(client, database_name, container_name)

    # Read event_grid data
    try:
        event_data = CosmosOperations.read_data("C:/Users/srika/Documents/Azure_Code/data")
    except Exception as e:
        print("Error reading data: {}".format(str(e)))
        return

    # Insert data
    CosmosOperations.insert_data(client, database_name, container_name, event_data)

    # Query data
    queried_data = CosmosOperations.query_data(client, database_name, container_name, 
                                               "SELECT * FROM c WHERE c.app_code='sample_app'")
    print(queried_data)

    # Update data 
    event_data["sft_batch_file_name"] = "batch124"
    CosmosOperations.update_data(client, database_name, container_name, event_data)

    # Delete data
    CosmosOperations.delete_data(client, database_name, container_name, "1", "sample_app")

def update_data(event_data, config_file='config.json'):
    client, database_name, container_name = CosmosOperations.client_init(config_file)
    CosmosOperations.update_data(client, database_name, container_name, event_data)

def delete_data(item_id, partition_value, config_file='config.json'):
    client, database_name, container_name = CosmosOperations.client_init(config_file)
    CosmosOperations.delete_data(client, database_name, container_name, item_id, partition_value)

if __name__ == '__main__':
    call_operations()
